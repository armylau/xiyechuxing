<!-- pages/explore/explore.wxml - åƒä½æ¨èé¡µ -->
<view class="page">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-content">
      <text class="header-title">ğŸ½ï¸ åƒä½æ¨è</text>
      <text class="header-subtitle">å‘ç°ç›®çš„åœ°ç¾é£Ÿä¸ä¼˜é€‰é…’åº—</text>
    </view>
  </view>

  <!-- æ§åˆ¶æ  -->
  <view class="control-bar">
    <!-- åŸå¸‚é€‰æ‹© -->
    <picker bindchange="onCityChange" value="{{currentCityIndex}}" range="{{cities}}" range-key="name">
      <view class="city-picker">
        <text>{{currentCityName}}</text>
        <text class="arrow">â–¼</text>
      </view>
    </picker>

    <!-- Tab åˆ‡æ¢ -->
    <view class="tab-switch">
      <view 
        class="tab-item {{activeTab === 'food' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="food"
      >ğŸœ ç¾é£Ÿ</view>
      <view 
        class="tab-item {{activeTab === 'hotel' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="hotel"
      >ğŸ¨ é…’åº—</view>
    </view>
  </view>

  <!-- å†…å®¹åˆ—è¡¨ -->
  <view class="content-list">
    <!-- åŠ è½½ä¸­ -->
    <view class="loading" wx:if="{{loading}}">
      <view class="spinner"></view>
    </view>

    <!-- ========== ç¾é£Ÿåˆ—è¡¨ ========== -->
    <block wx:if="{{activeTab === 'food' && !loading}}">
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{foodList.length === 0}}">
        <text class="empty-icon">ğŸœ</text>
        <text class="empty-text">æš‚æ— ç¾é£Ÿæ¨è</text>
      </view>

      <!-- ç¾é£Ÿå¡ç‰‡ -->
      <view class="rec-card" wx:for="{{foodList}}" wx:key="name">
        <view class="card-header">
          <text class="card-icon">{{item.icon}}</text>
          <view class="card-info">
            <text class="card-title">{{item.name}}</text>
            <text class="card-sub">
              {{item.type}} Â· 
              <text wx:if="{{item.amap_url}}" class="link" bindtap="openMap" data-url="{{item.amap_url}}">
                {{item.address}} ğŸ“
              </text>
              <text wx:else>{{item.address}}</text>
            </text>
          </view>
        </view>
        <text class="card-desc">{{item.desc}}</text>
        <view class="card-tags">
          <text class="tag tag-blue" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
        </view>
        <view class="card-footer">
          <text class="rating">â­ {{item.rating}}</text>
          <text class="price">
            <text class="price-num">Â¥{{item.price_per_person}}</text>
            <text class="price-unit">/äºº</text>
          </text>
        </view>
      </view>
    </block>

    <!-- ========== é…’åº—åˆ—è¡¨ ========== -->
    <block wx:if="{{activeTab === 'hotel' && !loading}}">
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{hotelList.length === 0}}">
        <text class="empty-icon">ğŸ¨</text>
        <text class="empty-text">æš‚æ— é…’åº—æ¨è</text>
      </view>

      <!-- é…’åº—å¡ç‰‡ -->
      <view class="rec-card" wx:for="{{hotelList}}" wx:key="name">
        <view class="card-header">
          <text class="card-icon">{{item.icon}}</text>
          <view class="card-info">
            <text class="card-title">{{item.name}}</text>
            <text class="card-sub">
              <text class="stars">{{item.starsText}}</text> Â· 
              <text wx:if="{{item.amap_url}}" class="link" bindtap="openMap" data-url="{{item.amap_url}}">
                {{item.address}} ğŸ“
              </text>
              <text wx:else>{{item.address}}</text>
            </text>
          </view>
        </view>
        <text class="card-desc">{{item.desc}}</text>
        <view class="card-tags">
          <text class="tag tag-blue" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
          <text class="tag tag-purple">{{item.distance}}</text>
        </view>
        <view class="card-footer">
          <text class="rating">â­ {{item.rating}}</text>
          <text class="price">
            <text class="price-num">Â¥{{item.price}}</text>
            <text class="price-unit">/æ™š</text>
          </text>
        </view>
      </view>
    </block>
  </view>
</view>
